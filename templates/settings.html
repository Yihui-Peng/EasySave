{% extends "base.html" %}
{% block title %}Settings{% endblock %}

{% block styles %}
<style>
    .option {
        cursor: pointer;
        margin: 5px 0;
    }
    .hidden {
        display: none;
    }
    .back {
        cursor: pointer;
        color: blue;
        text-decoration: underline;
    }
</style>
{% endblock %}

{% block content %}
<div class="scrollable-container">
    <h1>Settings Menu</h1>
    <div id="menu" class="section">
        <div class="option" onclick="accountSecurity()">Account Security</div>
        <div class="option" onclick="signOut()">Sign Out</div>
        <div class="option" onclick="companyInfo()">Company Info</div>
    </div>

    <!-- Select Language Section -->
    <div id="language-section" class="section hidden">
        <h2>Select Language</h2>
        <div class="option" onclick="displayMessage('Language selected: English')">1: English</div>
        <div class="option" onclick="displayMessage('Language selected: Dutch')">2: Dutch</div>
        <div class="option" onclick="displayMessage('Language selected: Chinese')">3: Chinese</div>
        <div class="back" onclick="goBack()">Back to Menu</div>
    </div>

    <!-- Account Security Section -->
    <div id="account-section" class="section hidden">
        <h2>Account Security</h2>
        <div class="option" onclick="changePassword()">1: Change Password</div>
        <div class="back" onclick="goBack()">Back to Menu</div>
    </div>

    <!-- Color Setting Section -->
    <div id="color-section" class="section hidden">
        <h2>Color Setting</h2>
        <div class="option" onclick="displayMessage('Background set to Black')">1: Black</div>
        <div class="option" onclick="displayMessage('Background set to White')">2: White</div>
        <div class="back" onclick="goBack()">Back to Menu</div>
    </div>

    <!-- Company Info Section -->
    <div id="company-section" class="section hidden">
        <h2>Company Info</h2>
        <p>Company: EasySave</p>
        <p>Address: Einsteinweg, Leiden, Netherlands</p>
        <p>Email: contact@example.com</p>
        <div class="back" onclick="goBack()">Back to Menu</div>
    </div>
</div>

<script>
    function hideAllSections() {
        document.getElementById("menu").classList.add("hidden");
        document.getElementById("language-section").classList.add("hidden");
        document.getElementById("account-section").classList.add("hidden");
        document.getElementById("color-section").classList.add("hidden");
        document.getElementById("company-section").classList.add("hidden");
    }

    function goBack() {
        hideAllSections();
        document.getElementById("menu").classList.remove("hidden");
    }

    function accountSecurity() {
        hideAllSections();
        document.getElementById("account-section").classList.remove("hidden");
    }

    function signOut() {
        const confirmation = confirm("Are you sure you want to sign out?");
        if (confirmation) {
            window.location.href = "/login";
        }
    }

    function companyInfo() {
        hideAllSections();
        document.getElementById("company-section").classList.remove("hidden");
    }

    function changePassword() {
        const currentPassword = prompt("Enter your current password:");
        const newPassword = prompt("Enter your new password:");
        if (currentPassword && newPassword) {
            fetch('/setting', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ action: 'change_password', current_password: currentPassword, new_password: newPassword })
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => console.error('Error:', error));
        }
    }

    function displayMessage(message) {
        alert(message);
        goBack();
    }
</script>
{% endblock %}
