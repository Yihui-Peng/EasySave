<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Survey</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
</head>
<body>
    <button id="openSurvey">Financial Survey</button>

    <div id="surveyDialog" title="Financial Survey" style="display: none;">
        <form id="financialSurveyForm" action="/survey" method="post">
            <!-- Question 1 (Merged) -->
            <p>1. What is your average monthly disposable income for the last three months (including living expenses, allowances, and income from part-time jobs and internships)?</p>
            <label>Amount: <input type="number" name="averageDisposableIncome" min="0" required></label>

            <!-- Question 2 -->
            <p>2. Do you want to set a savings goal for next month? </p>
            <label><input type="radio" name="savingsGoal" value="yes" required> Yes</label>
            <label><input type="radio" name="savingsGoal" value="no" required> No</label>
            <div id="savingsGoalAmount" style="display: none;">
                <label>Enter your monthly savings goal: <input type="number" name="goalAmount" required></label>
            </div>

            <!-- Question 3 -->
            <p>3. In the last three months, what was your average monthly spending?</p>
            <label>Amount: <input type="number" name="averageSpending" min="0" required></label>

            <!-- Question 4 -->
            <p>4. Please enter your financial records for the past three months (starting from the previous month)</p>
            <div id="financialRecords">
                <table id="monthlyRecordsTable">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>October</th>
                            <th>September</th>
                            <th>August</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Income</td>
                            <td><input type="number" name="October_Income" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Income" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Income" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Allowance</td>
                            <td><input type="number" name="October_Allowance" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Allowance" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Allowance" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Living Expense</td>
                            <td><input type="number" name="October_LivingExpense" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_LivingExpense" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_LivingExpense" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Tuition</td>
                            <td><input type="number" name="October_Tuition" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Tuition" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Tuition" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Housing</td>
                            <td><input type="number" name="October_Housing" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Housing" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Housing" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Food</td>
                            <td><input type="number" name="October_Food" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Food" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Food" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Transportation</td>
                            <td><input type="number" name="October_Transportation" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Transportation" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Transportation" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Study Material</td>
                            <td><input type="number" name="October_StudyMaterial" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_StudyMaterial" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_StudyMaterial" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Entertainment</td>
                            <td><input type="number" name="October_Entertainment" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Entertainment" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Entertainment" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Personal Care</td>
                            <td><input type="number" name="October_PersonalCare" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_PersonalCare" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_PersonalCare" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Technology</td>
                            <td><input type="number" name="October_Technology" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Technology" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Technology" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Apparel</td>
                            <td><input type="number" name="October_Apparel" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Apparel" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Apparel" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Travel</td>
                            <td><input type="number" name="October_Travel" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Travel" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Travel" style="width: 60%;" min="0" required></td>
                        </tr>
                        <tr>
                            <td>Others</td>
                            <td><input type="number" name="October_Others" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="September_Others" style="width: 60%;" min="0" required></td>
                            <td><input type="number" name="August_Others" style="width: 60%;" min="0" required></td>
                        </tr>
                    </tbody>
                 </table>
                <label><input type="checkbox" id="skipFinancialRecords" name="skipFinancialRecords" value="yes"> Skip</label>

            </div>

            <br><br>
            <input type="submit" value="Submit">
        </form>
    </div>

    <script>
        $(function () {
            const currentMonth = new Date().getMonth() + 1;
            const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

            $("#openSurvey").click(function () {
                $("#surveyDialog").dialog({
                    width: 600,
                    modal: true
                });
            });

            $("input[name='savingsGoal']").change(function () {
                if ($(this).val() === "yes") {
                    $("#savingsGoalAmount").show();
                    // 添加 required 属性
                    $("input[name='goalAmount']").attr('required', 'required');
                } else {
                    $("#savingsGoalAmount").hide();
                    // 移除 required 属性
                    $("input[name='goalAmount']").removeAttr('required');
                }
            });

             $("#skipFinancialRecords").change(function () {
                if ($(this).is(":checked")) {
                    $("#financialRecords").hide();
                    // 移除所有输入字段的required属性
                    $("#financialRecords").find('input').each(function() {
                        $(this).data('required', $(this).attr('required')); // 备份required属性
                        $(this).removeAttr('required');
                    });
                } else {
                    $("#financialRecords").show();
                    // 恢复所有输入字段的required属性
                    $("#financialRecords").find('input').each(function() {
                        if ($(this).data('required') != undefined) {
                            $(this).attr('required', $(this).data('required'));
                        }
                    });
                }
            });

        });
    </script>
</body>
</html>